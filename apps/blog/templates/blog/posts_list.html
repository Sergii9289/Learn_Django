{% extends "base.html" %}
{% load static %}

{% block title %}–°–ø–∏—Å–æ–∫ –ø–æ—Å—Ç—ñ–≤{% endblock %}

{% block content %}
<div class="container mt-5">

    <!-- –ù–∞–≤—ñ–≥–∞—Ü—ñ—è –≤–∫–ª–∞–¥–æ–∫ -->
    <ul class="nav nav-pills mb-3" id="contentTabs" role="tablist">
        <li class="nav-item" role="presentation">
            <button class="nav-link active" id="posts-tab" data-bs-toggle="tab" data-bs-target="#posts" type="button"
                    role="tab">
                üìö –°–ø–∏—Å–æ–∫ –ø–æ—Å—Ç—ñ–≤
            </button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="authors-tab" data-bs-toggle="tab" data-bs-target="#authors" type="button"
                    role="tab">
                üë§ –°–ø–∏—Å–æ–∫ –∞–≤—Ç–æ—Ä—ñ–≤
            </button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="categories-tab" data-bs-toggle="tab" data-bs-target="#categories" type="button"
                    role="tab">
                üè∑ –ö–∞—Ç–µ–≥–æ—Ä—ñ—ó
            </button>
        </li>
    </ul>

    <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –≤–∫–ª–∞–¥–æ–∫ -->
    <div class="tab-content" id="contentTabsContent">

        <!-- –í–∫–ª–∞–¥–∫–∞ –ø–æ—Å—Ç—ñ–≤ -->
        <div class="tab-pane fade show active" id="posts" role="tabpanel" aria-labelledby="posts-tab">
            <table class="table table-hover align-middle">
                <thead class="table-light">
                <tr>
                    <th>–ê–≤–∞—Ç–∞—Ä</th>
                    <th>–ê–≤—Ç–æ—Ä</th>
                    <th>–ó–∞–≥–æ–ª–æ–≤–æ–∫</th>
                    <th>–ö–æ–Ω—Ç–µ–Ω—Ç</th>
                    <th>–î—ñ—ó</th>
                    <th>–ö–∞—Ç–µ–≥–æ—Ä—ñ—ó</th>
                </tr>
                </thead>
                <tbody>
                {% for post in object_list %}
                <tr>
                    <td>
                        {% if post.author.avatar %}
                        <a href="#" data-bs-toggle="modal" data-bs-target="#avatarModal{{ post.pk }}">
                            <img src="{{ post.author.avatar.url }}" alt="{{ post.author.name }}"
                                 class="rounded-circle" width="40" height="40">
                        </a>
                        <!-- –ú–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ -->
                        <div class="modal fade" id="avatarModal{{ post.pk }}" tabindex="-1" aria-hidden="true">
                            <div class="modal-dialog modal-dialog-centered">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title">{{ post.author.name }}</h5>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal"
                                                aria-label="–ó–∞–∫—Ä–∏—Ç–∏"></button>
                                    </div>
                                    <div class="modal-body text-center">
                                        <img src="{{ post.author.avatar.url }}" alt="{{ post.author.name }}"
                                             class="img-fluid rounded">
                                    </div>
                                </div>
                            </div>
                        </div>
                        {% else %}
                        <span class="text-muted">‚Äî</span>
                        {% endif %}
                    </td>
                    <td>{{ post.author.name }}</td>
                    <td><a href="{{ post.get_absolute_url }}" class="fw-bold">{{ post.title }}</a></td>
                    <td>{{ post.content|truncatechars:50 }}</td>
                    <td>
                        <a href="{% url 'blog:post-update' post.pk %}" class="btn btn-sm btn-outline-primary"
                           title="–†–µ–¥–∞–≥—É–≤–∞—Ç–∏">
                            <i class="fas fa-edit"></i>
                        </a>
                        <a href="{% url 'blog:post-delete' post.pk %}" class="btn btn-sm btn-outline-danger"
                           title="–í–∏–¥–∞–ª–∏—Ç–∏">
                            <i class="fas fa-trash-alt"></i>
                        </a>
                    </td>
                    <td>
                        {% for category in post.categories.all %}
                        <span class="badge bg-info text-dark">{{ category.name }}</span>
                        {% empty %}
                        <span class="text-muted">‚Äî</span>
                        {% endfor %}
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="6" class="text-center text-muted">–ü–æ–∫–∏ –Ω–µ–º–∞—î –ø–æ—Å—Ç—ñ–≤</td>
                </tr>
                {% endfor %}
                </tbody>
            </table>
            <a href="{% url 'blog:post-create' %}" class="btn btn-success">‚ûï –°—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤—É —Å—Ç–∞—Ç—Ç—é</a>
        </div>
        <!-- –ü–∞–≥—ñ–Ω–∞—Ü—ñ—è -->
        {% if is_paginated %}
        <div class="pagination mt-3">
            {% if page_obj.has_previous %}
            <a href="?page={{ page_obj.previous_page_number }}" class="btn btn-outline-secondary">‚¨Ö –ü–æ–ø–µ—Ä–µ–¥–Ω—è</a>
            {% endif %}

            <span class="mx-2">–°—Ç–æ—Ä—ñ–Ω–∫–∞ {{ page_obj.number }} –∑ {{ paginator.num_pages }}</span>

            {% if page_obj.has_next %}
            <a href="?page={{ page_obj.next_page_number }}" class="btn btn-outline-secondary">–ù–∞—Å—Ç—É–ø–Ω–∞ ‚û°</a>
            {% endif %}
        </div>
        {% endif %}

        <!-- –í–∫–ª–∞–¥–∫–∞ –∞–≤—Ç–æ—Ä—ñ–≤ -->
        <div class="tab-pane fade" id="authors" role="tabpanel" aria-labelledby="authors-tab">
            <ul class="list-group">
                {% for author in authors %}
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    {{ author.name }}
                    {% if author.avatar %}
                    <img src="{{ author.avatar.url }}" alt="{{ author.name }}" class="rounded-circle" width="30"
                         height="30">
                    {% endif %}
                </li>
                {% empty %}
                <li class="list-group-item text-muted">–ê–≤—Ç–æ—Ä—ñ–≤ –Ω–µ–º–∞—î</li>
                {% endfor %}
            </ul>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä—ñ–π -->
        <div class="tab-pane fade" id="categories" role="tabpanel" aria-labelledby="categories-tab">
            <ul class="list-group">
                {% for category in categories %}
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    {{ category.name }}
                    <span class="badge bg-secondary rounded-pill">
                        {{ category.post_count }}
                    </span>
                </li>
                {% empty %}
                <li class="list-group-item text-muted">–ö–∞—Ç–µ–≥–æ—Ä—ñ–π –Ω–µ–º–∞—î</li>
                {% endfor %}
            </ul>
        </div>

    </div>
</div>
{% endblock %}